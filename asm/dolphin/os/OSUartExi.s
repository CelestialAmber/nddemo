.include "macros.inc"

.section .text, "ax"  # 0x800065A0 - 0x80063CE0 ; 0x0005D740

.fn InitializeUART, global
/* 8002F5A0 0002B520  7C 08 02 A6 */	mflr r0
/* 8002F5A4 0002B524  90 01 00 04 */	stw r0, 0x4(r1)
/* 8002F5A8 0002B528  94 21 FF F8 */	stwu r1, -0x8(r1)
/* 8002F5AC 0002B52C  4B FF 81 41 */	bl OSGetConsoleType
/* 8002F5B0 0002B530  54 60 00 C7 */	rlwinm. r0, r3, 0, 3, 3
/* 8002F5B4 0002B534  40 82 00 14 */	bne .L_8002F5C8
/* 8002F5B8 0002B538  38 00 00 00 */	li r0, 0x0
/* 8002F5BC 0002B53C  90 0D 84 E8 */	stw r0, serEnabled@sda21(r13)
/* 8002F5C0 0002B540  38 60 00 02 */	li r3, 0x2
/* 8002F5C4 0002B544  48 00 00 14 */	b .L_8002F5D8
.L_8002F5C8:
/* 8002F5C8 0002B548  3C 60 A5 FF */	lis r3, 0xA5FF005A@ha
/* 8002F5CC 0002B54C  38 03 00 5A */	addi r0, r3, 0xA5FF005A@l
/* 8002F5D0 0002B550  90 0D 84 E8 */	stw r0, serEnabled@sda21(r13)
/* 8002F5D4 0002B554  38 60 00 00 */	li r3, 0x0
.L_8002F5D8:
/* 8002F5D8 0002B558  80 01 00 0C */	lwz r0, 0xc(r1)
/* 8002F5DC 0002B55C  38 21 00 08 */	addi r1, r1, 0x8
/* 8002F5E0 0002B560  7C 08 03 A6 */	mtlr r0
/* 8002F5E4 0002B564  4E 80 00 20 */	blr
.endfn InitializeUART

.fn ReadUARTN, global
/* 8002F5E8 0002B568  38 60 00 04 */	li r3, 0x4
/* 8002F5EC 0002B56C  4E 80 00 20 */	blr
.endfn ReadUARTN

.fn WriteUARTN, global
/* 8002F5F0 0002B570  7C 08 02 A6 */	mflr r0
/* 8002F5F4 0002B574  90 01 00 04 */	stw r0, 0x4(r1)
/* 8002F5F8 0002B578  94 21 FF D0 */	stwu r1, -0x30(r1)
/* 8002F5FC 0002B57C  BF 41 00 18 */	stmw r26, 0x18(r1)
/* 8002F600 0002B580  3B C3 00 00 */	addi r30, r3, 0x0
/* 8002F604 0002B584  3B E4 00 00 */	addi r31, r4, 0x0
/* 8002F608 0002B588  80 AD 84 E8 */	lwz r5, serEnabled@sda21(r13)
/* 8002F60C 0002B58C  3C 05 5A 01 */	addis r0, r5, 0x5a01
/* 8002F610 0002B590  28 00 00 5A */	cmplwi r0, 0x5a
/* 8002F614 0002B594  41 82 00 0C */	beq .L_8002F620
/* 8002F618 0002B598  38 60 00 02 */	li r3, 0x2
/* 8002F61C 0002B59C  48 00 01 C0 */	b .L_8002F7DC
.L_8002F620:
/* 8002F620 0002B5A0  38 60 00 00 */	li r3, 0x0
/* 8002F624 0002B5A4  38 80 00 01 */	li r4, 0x1
/* 8002F628 0002B5A8  38 A0 00 00 */	li r5, 0x0
/* 8002F62C 0002B5AC  4B FF B7 E9 */	bl EXILock
/* 8002F630 0002B5B0  2C 03 00 00 */	cmpwi r3, 0x0
/* 8002F634 0002B5B4  40 82 00 0C */	bne .L_8002F640
/* 8002F638 0002B5B8  38 60 00 00 */	li r3, 0x0
/* 8002F63C 0002B5BC  48 00 01 A0 */	b .L_8002F7DC
.L_8002F640:
/* 8002F640 0002B5C0  38 9E 00 00 */	addi r4, r30, 0x0
/* 8002F644 0002B5C4  38 60 00 0D */	li r3, 0xd
/* 8002F648 0002B5C8  48 00 00 18 */	b .L_8002F660
.L_8002F64C:
/* 8002F64C 0002B5CC  88 04 00 00 */	lbz r0, 0x0(r4)
/* 8002F650 0002B5D0  2C 00 00 0A */	cmpwi r0, 0xa
/* 8002F654 0002B5D4  40 82 00 08 */	bne .L_8002F65C
/* 8002F658 0002B5D8  98 64 00 00 */	stb r3, 0x0(r4)
.L_8002F65C:
/* 8002F65C 0002B5DC  38 84 00 01 */	addi r4, r4, 0x1
.L_8002F660:
/* 8002F660 0002B5E0  7C 1E 20 50 */	subf r0, r30, r4
/* 8002F664 0002B5E4  7C 00 F8 40 */	cmplw r0, r31
/* 8002F668 0002B5E8  41 80 FF E4 */	blt .L_8002F64C
/* 8002F66C 0002B5EC  3C 00 A0 01 */	lis r0, 0xa001
/* 8002F670 0002B5F0  90 01 00 14 */	stw r0, 0x14(r1)
/* 8002F674 0002B5F4  3B 40 00 00 */	li r26, 0x0
/* 8002F678 0002B5F8  3F A0 20 01 */	lis r29, 0x2001
/* 8002F67C 0002B5FC  48 00 01 4C */	b .L_8002F7C8
.L_8002F680:
/* 8002F680 0002B600  38 60 00 00 */	li r3, 0x0
/* 8002F684 0002B604  38 80 00 01 */	li r4, 0x1
/* 8002F688 0002B608  38 A0 00 03 */	li r5, 0x3
/* 8002F68C 0002B60C  4B FF B1 29 */	bl EXISelect
/* 8002F690 0002B610  2C 03 00 00 */	cmpwi r3, 0x0
/* 8002F694 0002B614  40 82 00 0C */	bne .L_8002F6A0
/* 8002F698 0002B618  38 00 FF FF */	li r0, -0x1
/* 8002F69C 0002B61C  48 00 00 5C */	b .L_8002F6F8
.L_8002F6A0:
/* 8002F6A0 0002B620  93 A1 00 10 */	stw r29, 0x10(r1)
/* 8002F6A4 0002B624  38 81 00 10 */	addi r4, r1, 0x10
/* 8002F6A8 0002B628  38 60 00 00 */	li r3, 0x0
/* 8002F6AC 0002B62C  38 A0 00 04 */	li r5, 0x4
/* 8002F6B0 0002B630  38 C0 00 01 */	li r6, 0x1
/* 8002F6B4 0002B634  38 E0 00 00 */	li r7, 0x0
/* 8002F6B8 0002B638  4B FF A9 5D */	bl EXIImm
/* 8002F6BC 0002B63C  38 60 00 00 */	li r3, 0x0
/* 8002F6C0 0002B640  4B FF AD 3D */	bl EXISync
/* 8002F6C4 0002B644  38 81 00 10 */	addi r4, r1, 0x10
/* 8002F6C8 0002B648  38 60 00 00 */	li r3, 0x0
/* 8002F6CC 0002B64C  38 A0 00 01 */	li r5, 0x1
/* 8002F6D0 0002B650  38 C0 00 00 */	li r6, 0x0
/* 8002F6D4 0002B654  38 E0 00 00 */	li r7, 0x0
/* 8002F6D8 0002B658  4B FF A9 3D */	bl EXIImm
/* 8002F6DC 0002B65C  38 60 00 00 */	li r3, 0x0
/* 8002F6E0 0002B660  4B FF AD 1D */	bl EXISync
/* 8002F6E4 0002B664  38 60 00 00 */	li r3, 0x0
/* 8002F6E8 0002B668  4B FF B1 F9 */	bl EXIDeselect
/* 8002F6EC 0002B66C  80 01 00 10 */	lwz r0, 0x10(r1)
/* 8002F6F0 0002B670  54 00 46 3E */	srwi r0, r0, 24
/* 8002F6F4 0002B674  20 00 00 10 */	subfic r0, r0, 0x10
.L_8002F6F8:
/* 8002F6F8 0002B678  2C 00 00 00 */	cmpwi r0, 0x0
/* 8002F6FC 0002B67C  7C 1B 03 78 */	mr r27, r0
/* 8002F700 0002B680  40 80 00 0C */	bge .L_8002F70C
/* 8002F704 0002B684  3B 40 FF FF */	li r26, -0x1
/* 8002F708 0002B688  48 00 00 C8 */	b .L_8002F7D0
.L_8002F70C:
/* 8002F70C 0002B68C  2C 00 00 0C */	cmpwi r0, 0xc
/* 8002F710 0002B690  40 80 00 0C */	bge .L_8002F71C
/* 8002F714 0002B694  7C 00 F8 40 */	cmplw r0, r31
/* 8002F718 0002B698  41 80 00 B0 */	blt .L_8002F7C8
.L_8002F71C:
/* 8002F71C 0002B69C  38 60 00 00 */	li r3, 0x0
/* 8002F720 0002B6A0  38 80 00 01 */	li r4, 0x1
/* 8002F724 0002B6A4  38 A0 00 03 */	li r5, 0x3
/* 8002F728 0002B6A8  4B FF B0 8D */	bl EXISelect
/* 8002F72C 0002B6AC  2C 03 00 00 */	cmpwi r3, 0x0
/* 8002F730 0002B6B0  40 82 00 0C */	bne .L_8002F73C
/* 8002F734 0002B6B4  3B 40 FF FF */	li r26, -0x1
/* 8002F738 0002B6B8  48 00 00 98 */	b .L_8002F7D0
.L_8002F73C:
/* 8002F73C 0002B6BC  38 81 00 14 */	addi r4, r1, 0x14
/* 8002F740 0002B6C0  38 60 00 00 */	li r3, 0x0
/* 8002F744 0002B6C4  38 A0 00 04 */	li r5, 0x4
/* 8002F748 0002B6C8  38 C0 00 01 */	li r6, 0x1
/* 8002F74C 0002B6CC  38 E0 00 00 */	li r7, 0x0
/* 8002F750 0002B6D0  4B FF A8 C5 */	bl EXIImm
/* 8002F754 0002B6D4  38 60 00 00 */	li r3, 0x0
/* 8002F758 0002B6D8  4B FF AC A5 */	bl EXISync
/* 8002F75C 0002B6DC  48 00 00 54 */	b .L_8002F7B0
.L_8002F760:
/* 8002F760 0002B6E0  2C 1B 00 04 */	cmpwi r27, 0x4
/* 8002F764 0002B6E4  40 80 00 0C */	bge .L_8002F770
/* 8002F768 0002B6E8  7C 1B F8 40 */	cmplw r27, r31
/* 8002F76C 0002B6EC  41 80 00 54 */	blt .L_8002F7C0
.L_8002F770:
/* 8002F770 0002B6F0  28 1F 00 04 */	cmplwi r31, 0x4
/* 8002F774 0002B6F4  40 80 00 0C */	bge .L_8002F780
/* 8002F778 0002B6F8  7F FC FB 78 */	mr r28, r31
/* 8002F77C 0002B6FC  48 00 00 08 */	b .L_8002F784
.L_8002F780:
/* 8002F780 0002B700  3B 80 00 04 */	li r28, 0x4
.L_8002F784:
/* 8002F784 0002B704  38 BC 00 00 */	addi r5, r28, 0x0
/* 8002F788 0002B708  38 9E 00 00 */	addi r4, r30, 0x0
/* 8002F78C 0002B70C  38 60 00 00 */	li r3, 0x0
/* 8002F790 0002B710  38 C0 00 01 */	li r6, 0x1
/* 8002F794 0002B714  38 E0 00 00 */	li r7, 0x0
/* 8002F798 0002B718  4B FF A8 7D */	bl EXIImm
/* 8002F79C 0002B71C  7F DE E2 14 */	add r30, r30, r28
/* 8002F7A0 0002B720  7F FC F8 50 */	subf r31, r28, r31
/* 8002F7A4 0002B724  7F 7C D8 50 */	subf r27, r28, r27
/* 8002F7A8 0002B728  38 60 00 00 */	li r3, 0x0
/* 8002F7AC 0002B72C  4B FF AC 51 */	bl EXISync
.L_8002F7B0:
/* 8002F7B0 0002B730  2C 1B 00 00 */	cmpwi r27, 0x0
/* 8002F7B4 0002B734  41 82 00 0C */	beq .L_8002F7C0
/* 8002F7B8 0002B738  28 1F 00 00 */	cmplwi r31, 0x0
/* 8002F7BC 0002B73C  40 82 FF A4 */	bne .L_8002F760
.L_8002F7C0:
/* 8002F7C0 0002B740  38 60 00 00 */	li r3, 0x0
/* 8002F7C4 0002B744  4B FF B1 1D */	bl EXIDeselect
.L_8002F7C8:
/* 8002F7C8 0002B748  28 1F 00 00 */	cmplwi r31, 0x0
/* 8002F7CC 0002B74C  40 82 FE B4 */	bne .L_8002F680
.L_8002F7D0:
/* 8002F7D0 0002B750  38 60 00 00 */	li r3, 0x0
/* 8002F7D4 0002B754  4B FF B7 35 */	bl EXIUnlock
/* 8002F7D8 0002B758  7F 43 D3 78 */	mr r3, r26
.L_8002F7DC:
/* 8002F7DC 0002B75C  BB 41 00 18 */	lmw r26, 0x18(r1)
/* 8002F7E0 0002B760  80 01 00 34 */	lwz r0, 0x34(r1)
/* 8002F7E4 0002B764  38 21 00 30 */	addi r1, r1, 0x30
/* 8002F7E8 0002B768  7C 08 03 A6 */	mtlr r0
/* 8002F7EC 0002B76C  4E 80 00 20 */	blr
.endfn WriteUARTN

.section .sbss, "", @nobits  # 0x800A8DC0 - 0x800A9380

serEnabled:
	.skip 0x4

.skip 4