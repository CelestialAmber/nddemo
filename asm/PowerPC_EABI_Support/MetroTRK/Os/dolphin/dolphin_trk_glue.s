.include "macros.inc"

.section .text, "ax"  # 0x800065A0 - 0x80063CE0 ; 0x0005D740

.fn TRKLoadContext, global
/* 8005EC7C 0005ABFC  80 03 00 00 */	lwz r0, 0x0(r3)
/* 8005EC80 0005AC00  80 23 00 04 */	lwz r1, 0x4(r3)
/* 8005EC84 0005AC04  80 43 00 08 */	lwz r2, 0x8(r3)
/* 8005EC88 0005AC08  A0 A3 01 A2 */	lhz r5, 0x1a2(r3)
/* 8005EC8C 0005AC0C  54 A6 07 BD */	rlwinm. r6, r5, 0, 30, 30
/* 8005EC90 0005AC10  41 82 00 14 */	beq .L_8005ECA4
/* 8005EC94 0005AC14  54 A5 07 FA */	rlwinm r5, r5, 0, 31, 29
/* 8005EC98 0005AC18  B0 A3 01 A2 */	sth r5, 0x1a2(r3)
/* 8005EC9C 0005AC1C  B8 A3 00 14 */	lmw r5, 0x14(r3)
/* 8005ECA0 0005AC20  48 00 00 08 */	b .L_8005ECA8
.L_8005ECA4:
/* 8005ECA4 0005AC24  B9 A3 00 34 */	lmw r13, 0x34(r3)
.L_8005ECA8:
/* 8005ECA8 0005AC28  7C 7F 1B 78 */	mr r31, r3
/* 8005ECAC 0005AC2C  7C 83 23 78 */	mr r3, r4
/* 8005ECB0 0005AC30  80 9F 00 80 */	lwz r4, 0x80(r31)
/* 8005ECB4 0005AC34  7C 8F F1 20 */	mtcrf 255, r4
/* 8005ECB8 0005AC38  80 9F 00 84 */	lwz r4, 0x84(r31)
/* 8005ECBC 0005AC3C  7C 88 03 A6 */	mtlr r4
/* 8005ECC0 0005AC40  80 9F 00 88 */	lwz r4, 0x88(r31)
/* 8005ECC4 0005AC44  7C 89 03 A6 */	mtctr r4
/* 8005ECC8 0005AC48  80 9F 00 8C */	lwz r4, 0x8c(r31)
/* 8005ECCC 0005AC4C  7C 81 03 A6 */	mtxer r4
/* 8005ECD0 0005AC50  7C 80 00 A6 */	mfmsr r4
/* 8005ECD4 0005AC54  54 84 04 5E */	rlwinm r4, r4, 0, 17, 15
/* 8005ECD8 0005AC58  54 84 07 FA */	rlwinm r4, r4, 0, 31, 29
/* 8005ECDC 0005AC5C  7C 80 01 24 */	mtmsr r4
/* 8005ECE0 0005AC60  7C 51 43 A6 */	mtsprg 1, r2
/* 8005ECE4 0005AC64  80 9F 00 0C */	lwz r4, 0xc(r31)
/* 8005ECE8 0005AC68  7C 92 43 A6 */	mtsprg 2, r4
/* 8005ECEC 0005AC6C  80 9F 00 10 */	lwz r4, 0x10(r31)
/* 8005ECF0 0005AC70  7C 93 43 A6 */	mtsprg 3, r4
/* 8005ECF4 0005AC74  80 5F 01 98 */	lwz r2, 0x198(r31)
/* 8005ECF8 0005AC78  80 9F 01 9C */	lwz r4, 0x19c(r31)
/* 8005ECFC 0005AC7C  83 FF 00 7C */	lwz r31, 0x7c(r31)
/* 8005ED00 0005AC80  4B FF ED 40 */	b TRKInterruptHandler
.endfn TRKLoadContext

.fn TRKEXICallBack, global
/* 8005ED04 0005AC84  7C 08 02 A6 */	mflr r0
/* 8005ED08 0005AC88  90 01 00 04 */	stw r0, 0x4(r1)
/* 8005ED0C 0005AC8C  94 21 FF F0 */	stwu r1, -0x10(r1)
/* 8005ED10 0005AC90  93 E1 00 0C */	stw r31, 0xc(r1)
/* 8005ED14 0005AC94  7C 9F 23 78 */	mr r31, r4
/* 8005ED18 0005AC98  4B FC F8 C1 */	bl OSEnableScheduler
/* 8005ED1C 0005AC9C  7F E3 FB 78 */	mr r3, r31
/* 8005ED20 0005ACA0  38 80 05 00 */	li r4, 0x500
/* 8005ED24 0005ACA4  4B FF FF 59 */	bl TRKLoadContext
/* 8005ED28 0005ACA8  83 E1 00 0C */	lwz r31, 0xc(r1)
/* 8005ED2C 0005ACAC  38 21 00 10 */	addi r1, r1, 0x10
/* 8005ED30 0005ACB0  80 01 00 04 */	lwz r0, 0x4(r1)
/* 8005ED34 0005ACB4  7C 08 03 A6 */	mtlr r0
/* 8005ED38 0005ACB8  4E 80 00 20 */	blr
.endfn TRKEXICallBack

.fn InitMetroTRKCommTable, global
/* 8005ED3C 0005ACBC  7C 08 02 A6 */	mflr r0
/* 8005ED40 0005ACC0  90 01 00 04 */	stw r0, 0x4(r1)
/* 8005ED44 0005ACC4  94 21 FF F8 */	stwu r1, -0x8(r1)
/* 8005ED48 0005ACC8  2C 03 00 01 */	cmpwi r3, 0x1
/* 8005ED4C 0005ACCC  40 82 00 68 */	bne .L_8005EDB4
/* 8005ED50 0005ACD0  48 00 4F 89 */	bl Hu_IsStub
/* 8005ED54 0005ACD4  3C A0 80 06 */	lis r5, DBInitComm@ha
/* 8005ED58 0005ACD8  3C 80 80 07 */	lis r4, gDBCommTable@ha
/* 8005ED5C 0005ACDC  38 05 38 7C */	addi r0, r5, DBInitComm@l
/* 8005ED60 0005ACE0  38 A4 CE 90 */	addi r5, r4, gDBCommTable@l
/* 8005ED64 0005ACE4  3C 80 80 06 */	lis r4, DBInitInterrupts@ha
/* 8005ED68 0005ACE8  90 05 00 00 */	stw r0, 0x0(r5)
/* 8005ED6C 0005ACEC  38 04 38 F4 */	addi r0, r4, DBInitInterrupts@l
/* 8005ED70 0005ACF0  3C 80 80 06 */	lis r4, DBQueryData@ha
/* 8005ED74 0005ACF4  90 05 00 04 */	stw r0, 0x4(r5)
/* 8005ED78 0005ACF8  38 04 39 48 */	addi r0, r4, DBQueryData@l
/* 8005ED7C 0005ACFC  3C 80 80 06 */	lis r4, DBRead@ha
/* 8005ED80 0005AD00  90 05 00 08 */	stw r0, 0x8(r5)
/* 8005ED84 0005AD04  38 04 39 E4 */	addi r0, r4, DBRead@l
/* 8005ED88 0005AD08  3C 80 80 06 */	lis r4, DBWrite@ha
/* 8005ED8C 0005AD0C  90 05 00 0C */	stw r0, 0xc(r5)
/* 8005ED90 0005AD10  38 04 3A 70 */	addi r0, r4, DBWrite@l
/* 8005ED94 0005AD14  3C 80 80 06 */	lis r4, DBOpen@ha
/* 8005ED98 0005AD18  90 05 00 10 */	stw r0, 0x10(r5)
/* 8005ED9C 0005AD1C  38 04 3C D0 */	addi r0, r4, DBOpen@l
/* 8005EDA0 0005AD20  3C 80 80 06 */	lis r4, DBClose@ha
/* 8005EDA4 0005AD24  90 05 00 14 */	stw r0, 0x14(r5)
/* 8005EDA8 0005AD28  38 04 3C D4 */	addi r0, r4, DBClose@l
/* 8005EDAC 0005AD2C  90 05 00 18 */	stw r0, 0x18(r5)
/* 8005EDB0 0005AD30  48 00 00 64 */	b .L_8005EE14
.L_8005EDB4:
/* 8005EDB4 0005AD34  48 00 44 9D */	bl AMC_IsStub
/* 8005EDB8 0005AD38  3C A0 80 06 */	lis r5, EXI2_Init@ha
/* 8005EDBC 0005AD3C  3C 80 80 07 */	lis r4, gDBCommTable@ha
/* 8005EDC0 0005AD40  38 05 32 28 */	addi r0, r5, EXI2_Init@l
/* 8005EDC4 0005AD44  38 A4 CE 90 */	addi r5, r4, gDBCommTable@l
/* 8005EDC8 0005AD48  3C 80 80 06 */	lis r4, EXI2_EnableInterrupts@ha
/* 8005EDCC 0005AD4C  90 05 00 00 */	stw r0, 0x0(r5)
/* 8005EDD0 0005AD50  38 04 32 2C */	addi r0, r4, EXI2_EnableInterrupts@l
/* 8005EDD4 0005AD54  3C 80 80 06 */	lis r4, EXI2_Poll@ha
/* 8005EDD8 0005AD58  90 05 00 04 */	stw r0, 0x4(r5)
/* 8005EDDC 0005AD5C  38 04 32 30 */	addi r0, r4, EXI2_Poll@l
/* 8005EDE0 0005AD60  3C 80 80 06 */	lis r4, EXI2_ReadN@ha
/* 8005EDE4 0005AD64  90 05 00 08 */	stw r0, 0x8(r5)
/* 8005EDE8 0005AD68  38 04 32 38 */	addi r0, r4, EXI2_ReadN@l
/* 8005EDEC 0005AD6C  3C 80 80 06 */	lis r4, EXI2_WriteN@ha
/* 8005EDF0 0005AD70  90 05 00 0C */	stw r0, 0xc(r5)
/* 8005EDF4 0005AD74  38 04 32 40 */	addi r0, r4, EXI2_WriteN@l
/* 8005EDF8 0005AD78  3C 80 80 06 */	lis r4, EXI2_Reserve@ha
/* 8005EDFC 0005AD7C  90 05 00 10 */	stw r0, 0x10(r5)
/* 8005EE00 0005AD80  38 04 32 48 */	addi r0, r4, EXI2_Reserve@l
/* 8005EE04 0005AD84  3C 80 80 06 */	lis r4, EXI2_Unreserve@ha
/* 8005EE08 0005AD88  90 05 00 14 */	stw r0, 0x14(r5)
/* 8005EE0C 0005AD8C  38 04 32 4C */	addi r0, r4, EXI2_Unreserve@l
/* 8005EE10 0005AD90  90 05 00 18 */	stw r0, 0x18(r5)
.L_8005EE14:
/* 8005EE14 0005AD94  38 21 00 08 */	addi r1, r1, 0x8
/* 8005EE18 0005AD98  80 01 00 04 */	lwz r0, 0x4(r1)
/* 8005EE1C 0005AD9C  7C 08 03 A6 */	mtlr r0
/* 8005EE20 0005ADA0  4E 80 00 20 */	blr
.endfn InitMetroTRKCommTable

.fn TRKUARTInterruptHandler, global
/* 8005EE24 0005ADA4  4E 80 00 20 */	blr
.endfn TRKUARTInterruptHandler

.fn TRKInitializeIntDrivenUART, global
/* 8005EE28 0005ADA8  7C 08 02 A6 */	mflr r0
/* 8005EE2C 0005ADAC  90 01 00 04 */	stw r0, 0x4(r1)
/* 8005EE30 0005ADB0  94 21 FF F8 */	stwu r1, -0x8(r1)
/* 8005EE34 0005ADB4  3C 60 80 07 */	lis r3, gDBCommTable@ha
/* 8005EE38 0005ADB8  38 63 CE 90 */	addi r3, r3, gDBCommTable@l
/* 8005EE3C 0005ADBC  3C 80 80 06 */	lis r4, TRKEXICallBack@ha
/* 8005EE40 0005ADC0  81 83 00 00 */	lwz r12, 0x0(r3)
/* 8005EE44 0005ADC4  38 84 ED 04 */	addi r4, r4, TRKEXICallBack@l
/* 8005EE48 0005ADC8  7C C3 33 78 */	mr r3, r6
/* 8005EE4C 0005ADCC  7D 88 03 A6 */	mtlr r12
/* 8005EE50 0005ADD0  4E 80 00 21 */	blrl
/* 8005EE54 0005ADD4  38 60 00 00 */	li r3, 0x0
/* 8005EE58 0005ADD8  38 21 00 08 */	addi r1, r1, 0x8
/* 8005EE5C 0005ADDC  80 01 00 04 */	lwz r0, 0x4(r1)
/* 8005EE60 0005ADE0  7C 08 03 A6 */	mtlr r0
/* 8005EE64 0005ADE4  4E 80 00 20 */	blr
.endfn TRKInitializeIntDrivenUART

.fn EnableEXI2Interrupts, global
/* 8005EE68 0005ADE8  7C 08 02 A6 */	mflr r0
/* 8005EE6C 0005ADEC  90 01 00 04 */	stw r0, 0x4(r1)
/* 8005EE70 0005ADF0  94 21 FF F8 */	stwu r1, -0x8(r1)
/* 8005EE74 0005ADF4  3C 60 80 07 */	lis r3, gDBCommTable@ha
/* 8005EE78 0005ADF8  38 63 CE 90 */	addi r3, r3, gDBCommTable@l
/* 8005EE7C 0005ADFC  81 83 00 04 */	lwz r12, 0x4(r3)
/* 8005EE80 0005AE00  7D 88 03 A6 */	mtlr r12
/* 8005EE84 0005AE04  4E 80 00 21 */	blrl
/* 8005EE88 0005AE08  38 21 00 08 */	addi r1, r1, 0x8
/* 8005EE8C 0005AE0C  80 01 00 04 */	lwz r0, 0x4(r1)
/* 8005EE90 0005AE10  7C 08 03 A6 */	mtlr r0
/* 8005EE94 0005AE14  4E 80 00 20 */	blr
.endfn EnableEXI2Interrupts

.fn TRKPollUART, global
/* 8005EE98 0005AE18  7C 08 02 A6 */	mflr r0
/* 8005EE9C 0005AE1C  90 01 00 04 */	stw r0, 0x4(r1)
/* 8005EEA0 0005AE20  94 21 FF F8 */	stwu r1, -0x8(r1)
/* 8005EEA4 0005AE24  3C 60 80 07 */	lis r3, gDBCommTable@ha
/* 8005EEA8 0005AE28  38 63 CE 90 */	addi r3, r3, gDBCommTable@l
/* 8005EEAC 0005AE2C  81 83 00 08 */	lwz r12, 0x8(r3)
/* 8005EEB0 0005AE30  7D 88 03 A6 */	mtlr r12
/* 8005EEB4 0005AE34  4E 80 00 21 */	blrl
/* 8005EEB8 0005AE38  38 21 00 08 */	addi r1, r1, 0x8
/* 8005EEBC 0005AE3C  80 01 00 04 */	lwz r0, 0x4(r1)
/* 8005EEC0 0005AE40  7C 08 03 A6 */	mtlr r0
/* 8005EEC4 0005AE44  4E 80 00 20 */	blr
.endfn TRKPollUART

.fn TRKReadUARTN, global
/* 8005EEC8 0005AE48  7C 08 02 A6 */	mflr r0
/* 8005EECC 0005AE4C  90 01 00 04 */	stw r0, 0x4(r1)
/* 8005EED0 0005AE50  94 21 FF F8 */	stwu r1, -0x8(r1)
/* 8005EED4 0005AE54  3C A0 80 07 */	lis r5, gDBCommTable@ha
/* 8005EED8 0005AE58  38 A5 CE 90 */	addi r5, r5, gDBCommTable@l
/* 8005EEDC 0005AE5C  81 85 00 0C */	lwz r12, 0xc(r5)
/* 8005EEE0 0005AE60  7D 88 03 A6 */	mtlr r12
/* 8005EEE4 0005AE64  4E 80 00 21 */	blrl
/* 8005EEE8 0005AE68  2C 03 00 00 */	cmpwi r3, 0x0
/* 8005EEEC 0005AE6C  40 82 00 0C */	bne .L_8005EEF8
/* 8005EEF0 0005AE70  38 60 00 00 */	li r3, 0x0
/* 8005EEF4 0005AE74  48 00 00 08 */	b .L_8005EEFC
.L_8005EEF8:
/* 8005EEF8 0005AE78  38 60 FF FF */	li r3, -0x1
.L_8005EEFC:
/* 8005EEFC 0005AE7C  38 21 00 08 */	addi r1, r1, 0x8
/* 8005EF00 0005AE80  80 01 00 04 */	lwz r0, 0x4(r1)
/* 8005EF04 0005AE84  7C 08 03 A6 */	mtlr r0
/* 8005EF08 0005AE88  4E 80 00 20 */	blr
.endfn TRKReadUARTN

.fn TRKWriteUARTN, global
/* 8005EF0C 0005AE8C  7C 08 02 A6 */	mflr r0
/* 8005EF10 0005AE90  90 01 00 04 */	stw r0, 0x4(r1)
/* 8005EF14 0005AE94  94 21 FF F8 */	stwu r1, -0x8(r1)
/* 8005EF18 0005AE98  3C A0 80 07 */	lis r5, gDBCommTable@ha
/* 8005EF1C 0005AE9C  38 A5 CE 90 */	addi r5, r5, gDBCommTable@l
/* 8005EF20 0005AEA0  81 85 00 10 */	lwz r12, 0x10(r5)
/* 8005EF24 0005AEA4  7D 88 03 A6 */	mtlr r12
/* 8005EF28 0005AEA8  4E 80 00 21 */	blrl
/* 8005EF2C 0005AEAC  2C 03 00 00 */	cmpwi r3, 0x0
/* 8005EF30 0005AEB0  40 82 00 0C */	bne .L_8005EF3C
/* 8005EF34 0005AEB4  38 60 00 00 */	li r3, 0x0
/* 8005EF38 0005AEB8  48 00 00 08 */	b .L_8005EF40
.L_8005EF3C:
/* 8005EF3C 0005AEBC  38 60 FF FF */	li r3, -0x1
.L_8005EF40:
/* 8005EF40 0005AEC0  38 21 00 08 */	addi r1, r1, 0x8
/* 8005EF44 0005AEC4  80 01 00 04 */	lwz r0, 0x4(r1)
/* 8005EF48 0005AEC8  7C 08 03 A6 */	mtlr r0
/* 8005EF4C 0005AECC  4E 80 00 20 */	blr
.endfn TRKWriteUARTN

.fn ReserveEXI2Port, global
/* 8005EF50 0005AED0  7C 08 02 A6 */	mflr r0
/* 8005EF54 0005AED4  90 01 00 04 */	stw r0, 0x4(r1)
/* 8005EF58 0005AED8  94 21 FF F8 */	stwu r1, -0x8(r1)
/* 8005EF5C 0005AEDC  3C 60 80 07 */	lis r3, gDBCommTable@ha
/* 8005EF60 0005AEE0  38 63 CE 90 */	addi r3, r3, gDBCommTable@l
/* 8005EF64 0005AEE4  81 83 00 14 */	lwz r12, 0x14(r3)
/* 8005EF68 0005AEE8  7D 88 03 A6 */	mtlr r12
/* 8005EF6C 0005AEEC  4E 80 00 21 */	blrl
/* 8005EF70 0005AEF0  38 21 00 08 */	addi r1, r1, 0x8
/* 8005EF74 0005AEF4  80 01 00 04 */	lwz r0, 0x4(r1)
/* 8005EF78 0005AEF8  7C 08 03 A6 */	mtlr r0
/* 8005EF7C 0005AEFC  4E 80 00 20 */	blr
.endfn ReserveEXI2Port

.fn UnreserveEXI2Port, global
/* 8005EF80 0005AF00  7C 08 02 A6 */	mflr r0
/* 8005EF84 0005AF04  90 01 00 04 */	stw r0, 0x4(r1)
/* 8005EF88 0005AF08  94 21 FF F8 */	stwu r1, -0x8(r1)
/* 8005EF8C 0005AF0C  3C 60 80 07 */	lis r3, gDBCommTable@ha
/* 8005EF90 0005AF10  38 63 CE 90 */	addi r3, r3, gDBCommTable@l
/* 8005EF94 0005AF14  81 83 00 18 */	lwz r12, 0x18(r3)
/* 8005EF98 0005AF18  7D 88 03 A6 */	mtlr r12
/* 8005EF9C 0005AF1C  4E 80 00 21 */	blrl
/* 8005EFA0 0005AF20  38 21 00 08 */	addi r1, r1, 0x8
/* 8005EFA4 0005AF24  80 01 00 04 */	lwz r0, 0x4(r1)
/* 8005EFA8 0005AF28  7C 08 03 A6 */	mtlr r0
/* 8005EFAC 0005AF2C  4E 80 00 20 */	blr
.endfn UnreserveEXI2Port

.fn TRK_board_display, global
/* 8005EFB0 0005AF30  7C 08 02 A6 */	mflr r0
/* 8005EFB4 0005AF34  90 01 00 04 */	stw r0, 0x4(r1)
/* 8005EFB8 0005AF38  94 21 FF F8 */	stwu r1, -0x8(r1)
/* 8005EFBC 0005AF3C  4C C6 31 82 */	crclr 4*cr1+eq
/* 8005EFC0 0005AF40  4B FC AC 25 */	bl OSReport
/* 8005EFC4 0005AF44  38 21 00 08 */	addi r1, r1, 0x8
/* 8005EFC8 0005AF48  80 01 00 04 */	lwz r0, 0x4(r1)
/* 8005EFCC 0005AF4C  7C 08 03 A6 */	mtlr r0
/* 8005EFD0 0005AF50  4E 80 00 20 */	blr
.endfn TRK_board_display

.section .data, "wa"  # 0x80065000 - 0x8006D1C0

.balign 8

.obj gDBCommTable, global
	.4byte 0
	.4byte 0
	.4byte 0
	.4byte 0
	.4byte 0
	.4byte 0
	.4byte 0
.endobj gDBCommTable
